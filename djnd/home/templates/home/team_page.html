{% extends "wrapper.html" %}
{% load static wagtailcore_tags i18n djnd_extras %}

{% block content %}
<div class="px-14 py-20">

  <h1 class="mb-12 text-5xl font-semibold">{{ page.title }}</h1>

  <form onsubmit="return false;" class="flex gap-2 mb-6" x-data="categoriesFilter">
  {% for category in team_member_categories %}
    <div>
      <input type="radio" name="team_member_categories" id="team_member_category_{{ category.id }}" value="{{ category.id }}" {% if forloop.first %}checked{% endif %} class="peer hidden" @change="select($event.target.value)">
      <label for="team_member_category_{{ category.id }}" class="block px-2.5 pt-1 pb-1.5 border border-dark rounded-full text-sm leading-none cursor-pointer peer-checked:bg-mint">{{ category.name }}</label>
    </div>
  {% endfor %}
  </form>
  <script>
    const selectedId = document.querySelector('input[name="team_member_categories"]:checked').value
    document.addEventListener('alpine:init', () => {
      Alpine.data('categoriesFilter', () => ({
        init() {
          this.select(this.selectedId)
        },
        selectedId,
        select(id) {
          this.selectedId = id
          document.querySelectorAll('[data-member-id]').forEach((el) => {
            const categoryIds = JSON.parse(el.getAttribute('data-category-ids'))
            if (categoryIds.includes(Number(id))) {
              el.classList.remove('hidden')
            } else {
              el.classList.add('hidden')
            }
          })
        }
      }))
    })
  </script>

  <div class="grid grid-cols-fill230 gap-6">
  {% for member in team_members %}
    <div class="border" data-member-id="{{ member.id }}" data-category-ids="{{ member.categories.all|idlist }}">
      <div class="border-b">
        <img src="https://placehold.it/200" alt="" class="w-full aspect-square">
      </div>
      <div class="p-4">
        <h2 class="text-2xl font-semibold">{{ member.name }}</h2>
        <p class="font-mono text-sm">{{ member.email }}</p>
        <p class="mt-4">{{ member.role }}</p>
      </div>
    </div>
  {% endfor %}
  </div>

</div>
{% endblock content %}
