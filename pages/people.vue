<template>
  <div>
    <page-title
      :title="$t('menu.people')"
      :text="$t('people.description')"
      color="secondary"
    />
    <filter-bar v-model="filters" single color="secondary" />
    <div class="wrapping-flex-tiles">
      <div v-for="person in filteredPeople" :key="person.id" class="flex-tile">
        <person-tile :person="person" />
      </div>
      <div v-for="n in 10" :key="`flex-spacer-${n}`" class="flex-tile" />
    </div>
    <div class="row justify-content-center">
      <div class="col volunteer">
        <div class="volunteer__icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
            fill="currentColor"
          >
            <path
              d="M439.954 445.992H166.375c-5.523 0-10-4.478-10-10s4.477-10 10-10h263.579V316.747l-83.154-29.73-66.636 40.669a10.003 10.003 0 0 1-10.866-.29l-58.831-40.354-90.512 29.889v109.722a10.001 10.001 0 0 1 6.42 9.34c0 5.522-4.477 10-10 10h-6.42c-5.523 0-10-4.478-10-10v-126.29a10 10 0 0 1 6.864-9.496l102.082-33.71a10.001 10.001 0 0 1 8.792 1.25l57.578 39.494 65.187-39.784a9.996 9.996 0 0 1 8.576-.88l94.286 33.71a9.999 9.999 0 0 1 6.634 9.416v126.29c0 5.522-4.477 9.999-10 9.999z"
            />
            <path
              d="M370.06 446.008h-.003l-189.994-.06c-5.521-.002-9.996-4.477-9.997-9.997l-.021-69.606c-.002-5.522 4.474-10.001 9.997-10.003h.003c5.521 0 9.998 4.475 10 9.997l.019 59.612 169.96.054-.219-60.346c-.02-5.522 4.441-10.016 9.964-10.036h.037c5.506 0 9.979 4.453 9.999 9.964l.255 70.385a10 10 0 0 1-10 10.036zm-90.106-200.016c-49.626 0-90-40.374-90-90s40.374-90 90-90c23.481 0 45.704 8.99 62.575 25.314 16.83 16.283 26.55 38.118 27.369 61.482.019.544-.006 1.081-.071 1.604.083.521.127 1.055.127 1.599 0 49.627-40.374 90.001-90 90.001zm0-160c-38.598 0-70 31.402-70 70s31.402 70 70 70 70-31.402 70-70c0-.425.026-.843.078-1.254a10.239 10.239 0 0 1-.122-1.249c-1.327-37.848-32.056-67.497-69.956-67.497zm-174.653 160c-14.226 0-30.478-1.709-43.156-14.387-6.513-6.513-10.1-15.174-10.1-24.389 0-9.214 3.586-17.875 10.099-24.389 6.798-6.798 14.373-10.103 23.159-10.103.463 0 .93.009 1.403.028a34.973 34.973 0 0 1-.028-1.404c0-8.785 3.305-16.36 10.102-23.158 6.524-6.524 15.196-10.117 24.417-10.117 9.211 0 17.871 3.586 24.382 10.097 12.667 12.668 14.375 28.903 14.375 43.113 0 6.206-.362 12.679-.746 19.532-.422 7.548-.859 15.353-.859 23.58a10.001 10.001 0 0 1-10 10c-8.216 0-16.01.435-23.546.854-6.842.383-13.305.743-19.502.743zm-19.997-53.267c-2.864 0-5.494.722-9.016 4.245-2.735 2.735-4.242 6.374-4.242 10.247s1.506 7.512 4.241 10.247c6.138 6.138 14.273 8.529 29.014 8.529 5.64 0 11.833-.345 18.389-.71 4.81-.269 9.721-.542 14.833-.713.172-5.125.447-10.048.717-14.871.367-6.565.714-12.767.714-18.414 0-14.718-2.388-22.841-8.518-28.971a14.388 14.388 0 0 0-10.24-4.239 14.437 14.437 0 0 0-10.274 4.26c-3.523 3.522-4.245 6.152-4.245 9.016 0 2.773.741 6.286 2.331 11.058a10 10 0 0 1-12.649 12.649c-4.768-1.592-8.281-2.333-11.055-2.333zm336.699-49.864c-4.114 0-8.35-.237-12.834-.488-4.834-.271-9.833-.55-15.057-.55-5.522 0-10-4.477-10-10 0-5.217-.278-10.209-.548-15.037-.249-4.478-.485-8.707-.485-12.814 0-9.345 1.176-21.247 10.342-30.412 4.879-4.88 11.369-7.567 18.273-7.567 6.903 0 13.394 2.688 18.273 7.567 4.44 4.44 6.892 9.354 7.447 14.959 5.605.556 10.521 3.007 14.961 7.449 4.887 4.887 7.578 11.384 7.578 18.292 0 6.903-2.688 13.391-7.566 18.27-9.158 9.157-21.048 10.331-30.384 10.331zm-18.136-20.792c2.234.102 4.384.222 6.42.335 4.197.235 8.161.457 11.716.457 8.468 0 13.022-1.255 16.243-4.476a5.792 5.792 0 0 0 1.708-4.126 5.83 5.83 0 0 0-1.722-4.151c-1.711-1.711-2.536-1.711-3.335-1.711-1.384 0-3.358.434-6.037 1.327a10 10 0 0 1-12.649-12.646c.893-2.68 1.326-4.656 1.326-6.039 0-.799 0-1.625-1.711-3.335a5.804 5.804 0 0 0-4.132-1.71 5.802 5.802 0 0 0-4.132 1.71c-3.227 3.226-4.483 7.788-4.483 16.27 0 3.551.221 7.509.454 11.701.113 2.026.234 4.167.334 6.394zm6.087 133.923c-16.542 0-30-13.458-30-30s13.458-30 30-30 30 13.458 30 30-13.458 30-30 30zm0-40c-5.514 0-10 4.486-10 10s4.486 10 10 10 10-4.486 10-10-4.486-10-10-10z"
            />
            <path
              d="M209.942 155.994c-4.896 0-9.174-3.6-9.887-8.587-.781-5.467 3.018-10.533 8.485-11.313 64.541-9.22 92.563-54.786 92.838-55.246 2.841-4.736 8.984-6.273 13.72-3.43 4.736 2.841 6.271 8.984 3.431 13.72-1.325 2.208-33.299 54.203-107.161 64.754-.479.068-.955.102-1.426.102z"
            />
            <path
              d="M314.028 140.437c-22.11 0-36.63-4.756-37.237-4.958-5.239-1.747-8.07-7.41-6.323-12.649a9.996 9.996 0 0 1 12.622-6.333c.297.095 12.442 3.94 30.938 3.94 11.225 0 22.496-1.395 33.5-4.146 5.358-1.341 10.787 1.917 12.127 7.276 1.34 5.358-1.918 10.787-7.275 12.126a158.254 158.254 0 0 1-38.352 4.744z"
            />
          </svg>
        </div>
        <i18n path="people.volunteer" tag="p" class="volunteer__text">
          <a
            href="mailto:vsi@danesjenovdan.si"
            target="_blank"
            rel="noopener noreferrer"
            place="email"
            >vsi@danesjenovdan.si</a
          >
        </i18n>
      </div>
    </div>
  </div>
</template>

<script>
import PageTitle from '~/components/PageTitle.vue';
import FilterBar from '~/components/FilterBar.vue';
import PersonTile from '~/components/PersonTile.vue';
import peopleJson from '~/assets/people.json';

export default {
  pageColor: 'secondary',
  nuxtI18n: {
    paths: {
      sl: '/posadka',
      en: '/people',
    },
  },
  components: {
    PageTitle,
    FilterBar,
    PersonTile,
  },
  data() {
    const sortedPeople = [...peopleJson.people].sort((a, b) => {
      const lastA = a.name.slice(a.name.lastIndexOf(' ') + 1);
      const lastB = b.name.slice(b.name.lastIndexOf(' ') + 1);
      return lastA.toLowerCase().localeCompare(lastB.toLowerCase(), 'sl');
    });
    return {
      filters: [
        { id: 'all', label: this.$t('people.tags.all'), active: true },
        { id: 'council', label: this.$t('people.tags.council'), active: false },
        { id: 'science', label: this.$t('people.tags.science'), active: false },
      ],
      people: sortedPeople,
    };
  },
  computed: {
    activeFilter() {
      return this.filters.filter((f) => f.active).map((f) => f.id)[0];
    },
    filteredPeople() {
      if (!this.activeFilter || this.activeFilter === 'all') {
        return this.people;
      }
      return this.people.filter(
        (person) => person.tags && person.tags.includes(this.activeFilter),
      );
    },
  },
  head() {
    return {
      title: this.$t('menu.people'),
    };
  },
};
</script>

<style lang="scss" scoped>
.wrapping-flex-tiles {
  @include wrapping-flex-tiles($width: 260px);
}

.volunteer {
  margin: 4rem 0;
  display: flex;
  align-items: center;
  flex-direction: column;
  max-width: 900px;

  @include media-breakpoint-up(lg) {
    flex-direction: row;
  }

  .volunteer__icon {
    width: 150px;
    height: 150px;
    flex: 0 0 150px;
    margin: 0 0 1.5rem 0;
    color: $color-red;

    @include media-breakpoint-up(lg) {
      width: 100px;
      height: 100px;
      flex: 0 0 100px;
      margin: 0 1.5rem 0 0;
    }
  }

  .volunteer__text {
    margin: 0;
    font-style: italic;
    font-size: 1.5rem;
    font-weight: 300;
    line-height: 1.3;
    text-align: center;

    @include media-breakpoint-up(lg) {
      text-align: left;
    }

    @include media-breakpoint-up(xl) {
      font-size: 1.75rem;
    }

    a {
      color: inherit;
      text-decoration: underline;

      &:hover {
        text-decoration: none;
      }
    }
  }
}
</style>
